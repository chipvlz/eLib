function stripstr(a){t=a.replace(/<(\/)?(html|head|title|body|h1|h2|h3|h4|h5|h6|p|br|hr|pre|em|strong|code|b|i|a|ul|li|ol|dl|dt|dd|table|tr|th|td|div|map)([^>]*)>/gi,""),t=t.replace(/<(\/)?(iframe|frameset|form|input|select|option|textarea|blockquote|address|object|label|noscript|script)([^>]*)>/gi,""),t=t.replace(/<(\/)?(canvas|caption|command|datalist|details|fieldset|figcaption|figure|footer|hgroup|keygen|legend|mark|menu|meter|nav)([^>]*)>/gi,""),t=t.replace(/<(\/)?(rp|rt|ruby|dfn|kbd|section|source|time|var|video|wbr|output|center|dir|font|frame|noframes|s|strike|tt|u)([^>]*)>/gi,""),t=t.replace(/<(\/)?(!DOCTYPE|!doctype|col|colgroup|del|dfn|kbd|q|samp|small|span|style|sub|summary|sup|tbody|tfoot|cite|meta|optgroup|)([^>]*)>/gi,""),t=t.replace(/<!--[^(-->)]+-->/g,""),$(".result textarea").val(t)}function sf(t,a){return t=t.replace(/á|à|ả|ã|ạ|ă|ắ|ặ|ằ|ẳ|ẵ|â|ấ|ầ|ẩ|ẫ|ậ|ä|å|æ/gi,"a"),t=t.replace(/đ|ð/gi,"d"),t=t.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),t=t.replace(/í|ì|ỉ|ĩ|ị|î|ï/gi,"i"),t=t.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),t=t.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),t=t.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),t=t.replace(/Á|À|Ả|Ã|Ạ|Ă|Ắ|Ặ|Ằ|Ẳ|Ẵ|Â|Ấ|Ầ|Ẩ|Ẫ|Ậ|Ä|Å|Æ/gi,"A"),t=t.replace(/Đ/gi,"d"),t=t.replace(/É|È|Ẻ|Ẽ|Ẹ|Ê|Ế|Ề|Ể|Ễ|Ệ|Ë/gi,"e"),t=t.replace(/Í|Ì|Ỉ|Ĩ|Ị|Î|Ï/gi,"i"),t=t.replace(/Ó|Ò|Ỏ|Õ|Ọ|Ô|Ố|Ồ|Ổ|Ỗ|Ộ|Ơ|Ớ|Ờ|Ở|Ỡ|Ợ/gi,"o"),t=t.replace(/Ú|Ù|Ủ|Ũ|Ụ|Ư|Ứ|Ừ|Ử|Ữ|Ự/gi,"u"),t=t.replace(/Ý|Ỳ|Ỷ|Ỹ|Ỵ/gi,"y"),t=t.replace(/ /gi,"-"),t=t.replace(/~|!|@|#|$|%|^|&|_|=|{|}|\|:|;|"|<|,|>|[.,]|[(,]|[),]/gi,""),1==a?(t+"").toUpperCase():(t+"").toLowerCase()}function str2num(t){return t="0"+t,t=parseFloat(t)}function utf8_encode(t){if(null===t||"undefined"==typeof t)return"";var a,r,e=t+"",o="",s=0;a=r=0,s=e.length;for(var n=0;s>n;n++){var i=e.charCodeAt(n),c=null;if(128>i)r++;else if(i>127&&2048>i)c=String.fromCharCode(i>>6|192,63&i|128);else if(55296!=(63488&i))c=String.fromCharCode(i>>12|224,i>>6&63|128,63&i|128);else{if(55296!=(64512&i))throw new RangeError("Unmatched trail surrogate at "+n);var l=e.charCodeAt(++n);if(56320!=(64512&l))throw new RangeError("Unmatched lead surrogate at "+(n-1));i=((1023&i)<<10)+(1023&l)+65536,c=String.fromCharCode(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}null!==c&&(r>a&&(o+=e.slice(a,r)),o+=c,a=r=n+1)}return r>a&&(o+=e.slice(a,s)),o}function md5(t){if(""==t)return"";var a,r,e,o,s,n,i,c,l,d,h=function(t,a){return t<<a|t>>>32-a},p=function(t,a){var r,e,o,s,n;return o=2147483648&t,s=2147483648&a,r=1073741824&t,e=1073741824&a,n=(1073741823&t)+(1073741823&a),r&e?2147483648^n^o^s:r|e?1073741824&n?3221225472^n^o^s:1073741824^n^o^s:n^o^s},u=function(t,a,r){return t&a|~t&r},f=function(t,a,r){return t&r|a&~r},m=function(t,a,r){return t^a^r},g=function(t,a,r){return a^(t|~r)},$=function(t,a,r,e,o,s,n){return t=p(t,p(p(u(a,r,e),o),n)),p(h(t,s),a)},w=function(t,a,r,e,o,s,n){return t=p(t,p(p(f(a,r,e),o),n)),p(h(t,s),a)},v=function(t,a,r,e,o,s,n){return t=p(t,p(p(m(a,r,e),o),n)),p(h(t,s),a)},y=function(t,a,r,e,o,s,n){return t=p(t,p(p(g(a,r,e),o),n)),p(h(t,s),a)},b=function(t){for(var a,r=t.length,e=r+8,o=(e-e%64)/64,s=16*(o+1),n=new Array(s-1),i=0,c=0;r>c;)a=(c-c%4)/4,i=c%4*8,n[a]=n[a]|t.charCodeAt(c)<<i,c++;return a=(c-c%4)/4,i=c%4*8,n[a]=n[a]|128<<i,n[s-2]=r<<3,n[s-1]=r>>>29,n},k=function(t){var a,r,e="",o="";for(r=0;3>=r;r++)a=t>>>8*r&255,o="0"+a.toString(16),e+=o.substr(o.length-2,2);return e},x=[],R=7,C=12,T=17,j=22,O=5,M=9,E=14,N=20,P=4,B=11,_=16,S=23,A=6,L=10,q=15,I=21;for(t=this.utf8_encode(t),x=b(t),i=1732584193,c=4023233417,l=2562383102,d=271733878,a=x.length,r=0;a>r;r+=16)e=i,o=c,s=l,n=d,i=$(i,c,l,d,x[r+0],R,3614090360),d=$(d,i,c,l,x[r+1],C,3905402710),l=$(l,d,i,c,x[r+2],T,606105819),c=$(c,l,d,i,x[r+3],j,3250441966),i=$(i,c,l,d,x[r+4],R,4118548399),d=$(d,i,c,l,x[r+5],C,1200080426),l=$(l,d,i,c,x[r+6],T,2821735955),c=$(c,l,d,i,x[r+7],j,4249261313),i=$(i,c,l,d,x[r+8],R,1770035416),d=$(d,i,c,l,x[r+9],C,2336552879),l=$(l,d,i,c,x[r+10],T,4294925233),c=$(c,l,d,i,x[r+11],j,2304563134),i=$(i,c,l,d,x[r+12],R,1804603682),d=$(d,i,c,l,x[r+13],C,4254626195),l=$(l,d,i,c,x[r+14],T,2792965006),c=$(c,l,d,i,x[r+15],j,1236535329),i=w(i,c,l,d,x[r+1],O,4129170786),d=w(d,i,c,l,x[r+6],M,3225465664),l=w(l,d,i,c,x[r+11],E,643717713),c=w(c,l,d,i,x[r+0],N,3921069994),i=w(i,c,l,d,x[r+5],O,3593408605),d=w(d,i,c,l,x[r+10],M,38016083),l=w(l,d,i,c,x[r+15],E,3634488961),c=w(c,l,d,i,x[r+4],N,3889429448),i=w(i,c,l,d,x[r+9],O,568446438),d=w(d,i,c,l,x[r+14],M,3275163606),l=w(l,d,i,c,x[r+3],E,4107603335),c=w(c,l,d,i,x[r+8],N,1163531501),i=w(i,c,l,d,x[r+13],O,2850285829),d=w(d,i,c,l,x[r+2],M,4243563512),l=w(l,d,i,c,x[r+7],E,1735328473),c=w(c,l,d,i,x[r+12],N,2368359562),i=v(i,c,l,d,x[r+5],P,4294588738),d=v(d,i,c,l,x[r+8],B,2272392833),l=v(l,d,i,c,x[r+11],_,1839030562),c=v(c,l,d,i,x[r+14],S,4259657740),i=v(i,c,l,d,x[r+1],P,2763975236),d=v(d,i,c,l,x[r+4],B,1272893353),l=v(l,d,i,c,x[r+7],_,4139469664),c=v(c,l,d,i,x[r+10],S,3200236656),i=v(i,c,l,d,x[r+13],P,681279174),d=v(d,i,c,l,x[r+0],B,3936430074),l=v(l,d,i,c,x[r+3],_,3572445317),c=v(c,l,d,i,x[r+6],S,76029189),i=v(i,c,l,d,x[r+9],P,3654602809),d=v(d,i,c,l,x[r+12],B,3873151461),l=v(l,d,i,c,x[r+15],_,530742520),c=v(c,l,d,i,x[r+2],S,3299628645),i=y(i,c,l,d,x[r+0],A,4096336452),d=y(d,i,c,l,x[r+7],L,1126891415),l=y(l,d,i,c,x[r+14],q,2878612391),c=y(c,l,d,i,x[r+5],I,4237533241),i=y(i,c,l,d,x[r+12],A,1700485571),d=y(d,i,c,l,x[r+3],L,2399980690),l=y(l,d,i,c,x[r+10],q,4293915773),c=y(c,l,d,i,x[r+1],I,2240044497),i=y(i,c,l,d,x[r+8],A,1873313359),d=y(d,i,c,l,x[r+15],L,4264355552),l=y(l,d,i,c,x[r+6],q,2734768916),c=y(c,l,d,i,x[r+13],I,1309151649),i=y(i,c,l,d,x[r+4],A,4149444226),d=y(d,i,c,l,x[r+11],L,3174756917),l=y(l,d,i,c,x[r+2],q,718787259),c=y(c,l,d,i,x[r+9],I,3951481745),i=p(i,e),c=p(c,o),l=p(l,s),d=p(d,n);var X=k(i)+k(c)+k(l)+k(d);return X.toLowerCase()}function setcolor(t){$.ajax({url:"../../process/set-color.php",type:"post",data:{color:t}})}function logout(){bootbox.confirm("Bạn có chắc là muốn đăng xuất?",function(t){1==t&&$.ajax({url:"../../logout.php",success:function(){window.location="../../trang-chu"}})})}function change_img(t){$("#img01").attr("src","../../410x550/"+$("#img"+t).attr("data")),$("#img01").attr("data-BigImgsrc","../../"+$("#img"+t).attr("data")),Layout.initImageZoom()}function wished(t){$("#wish").removeClass("default"),$("#wish").addClass("btn-primary"),$("#wishi").removeClass("fa-heart-o"),$("#wishi").addClass("fa-heart"),$("#wish").attr("onclick","delwish("+t+")")}function rmwish(t){$("#wish").removeClass("btn-primary"),$("#wish").addClass("default"),$("#wishi").removeClass("fa-heart"),$("#wishi").addClass("fa-heart-o"),$("#wish").attr("onclick","wish("+t+")")}function wish(t){return $.ajax({url:"../../process/add-to-wishlist.php",type:"post",dataType:"json",data:{id:t},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?("4"==a.id?bootbox.dialog({message:"Bạn có muốn đăng nhập để thêm sách vào yêu thích?",title:"Bạn chưa đăng nhập",buttons:{main:{label:"Đăng nhập",className:"btn-primary",callback:function(){window.location="../../dang-nhap"}}}}):"2"==a.id&&bootbox.alert("Sách này đã có trong danh sách yêu thích của bạn rồi"),void("1"==a.done&&wished(t))):(alert("ERROR"),!1)}}),!1}function delwish(t){return $.ajax({url:"../../process/add-to-wishlist.php",type:"post",dataType:"json",data:{id:t,del:1},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?("5"==a.id&&rmwish(t),void("1"==a.done&&rmwish(t))):(alert("ERROR"),!1)}}),!1}function delwish2(t){return $.ajax({url:"../../process/add-to-wishlist.php",type:"post",dataType:"json",data:{id:t,del:1},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?void(1==a.done&&("1"==$("#contentwish").attr("count")?($("#content2wish").hide("fast"),$("#emptywish").show("slow")):($("#contentwish").attr("count",str2num($("#contentwish").attr("count"))-1),$("#wish"+t).hide("slow")))):(alert("ERROR"),!1)}}),!1}function thanked(t,a){$("#tks"+t).removeClass("default"),$("#tks"+t).addClass("btn-primary"),$("#tksi"+t).removeClass("fa-thumbs-o-up"),$("#tksi"+t).addClass("fa-thumbs-up"),"0"!=a&&$("#tkst"+t).text(a)}function rmthanks(t,a){$("#tks"+t).removeClass("btn-primary"),$("#tks"+t).addClass("default"),$("#tksi"+t).removeClass("fa-thumbs-up"),$("#tksi"+t).addClass("fa-thumbs-o-up"),$("#tkst"+t).text(a)}function thanks(t){return $.ajax({url:"../../process/thanks.php",type:"post",dataType:"json",data:{id:t},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?("0"!=a.err&&"1"==a.err&&bootbox.dialog({message:"Bạn có muốn đăng nhập để thích nhận xét này?",title:"Bạn chưa đăng nhập",buttons:{main:{label:"Đăng nhập",className:"btn-primary",callback:function(){window.location="../../dang-nhap"}}}}),void("1"==a.done&&("1"==a.lol?thanked(t,a.thanks):rmthanks(t,a.thanks)))):(alert("ERROR"),!1)}}),!1}function fastview(t){$("#loading3").fadeIn("fast"),$.ajax({url:"../../process/fast-view.php",type:"post",dataType:"json",data:{id:t},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?void("1"==a.done&&($("#title0").text(a.title),$("#author0").text(a.author),$("#img0").attr("src","../../410x550/"+a.img1),$("#des0").text(a.des),0==a.remain?($("#remain0").text("Đã hết"),$("#btnborrow0").attr("style","background: #000;padding: 7px 10px;"),$("#btnborrow0").html("<i class='fa fa-slack'></i>&nbsp;&nbsp;Đã hết sách"),$("#btnborrow0").removeAttr("onclick")):($("#remain0").text(a.remain),$("#btnborrow0").attr("style","padding: 7px 10px;"),$("#btnborrow0").attr("onclick","cart("+t+")"),$("#btnborrow0").html("<i class='fa fa-legal'></i>&nbsp;&nbsp;Mượn")),$("#nrating0").text(a.nrating),$("#borrow0").text(a.borrow),$("#rating1").rateit("value",a.rating),$("#loading3").fadeOut("slow"))):(alert("ERROR"),!1)}})}function cart(t){$.ajax({url:"../../process/add-to-cart.php",type:"post",dataType:"json",data:{id:t},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?"4"==a.id?(bootbox.dialog({message:"Bạn có muốn đăng nhập để mượn sách?",title:"Bạn chưa đăng nhập",buttons:{main:{label:"Đăng nhập",className:"btn-primary",callback:function(){window.location="../../dang-nhap"}}}}),!1):"3"==a.id?(bootbox.alert("Lỗi"),!1):"3"==a.id?(bootbox.alert("Sách không có thật"),!1):"2"==a.id?(bootbox.alert("Sách đã có trong giỏ hàng"),!1):"6"==a.id?(bootbox.dialog({message:"Bạn có muốn thêm sách vào yêu thích để nhận thông bao khi có sách?",title:"Sách đã hết hàng",buttons:{main:{label:"Thêm vào yêu thích",className:"btn-primary",callback:function(){wish(t)}}}}),!1):"1"==a.limit?(bootbox.dialog({message:"Giỏ sách của bạn đã đầy, không thể tiếp tục thêm sách, bạn có muốn xem lại giỏ sách của mình?",title:"Giỏ sách của bạn đã đầy",buttons:{main:{label:"Xem lại",className:"btn-primary",callback:function(){window.location="../../gio-sach"}}}}),!1):void(1==a.done&&(window.location="../../gio-sach")):(alert("ERROR"),!1)}})}function delcart(t){$.ajax({url:"../../process/add-to-cart.php",type:"post",dataType:"json",data:{id:t,del:1},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?"5"==a.id?(alert("Lỗi"),!1):void(1==a.done&&("1"==$("#content3").attr("count")&&($("#content2").hide("fast"),$("#emptycart").show("slow"),$("#content3").text(0)),$("#content").attr("count",str2num($("#content").attr("count"))-1),$("#content3").attr("count",str2num($("#content").attr("count"))),$("#content3").text(str2num($("#content").attr("count"))),$("#content4").text(str2num($("#content").attr("count"))+" Cuốn"),$("#cart"+t).hide("slow",function(){$("#cart"+t).remove()}),$("#2cart"+t).hide("slow",function(){$("#2cart"+t).remove()}))):(alert("ERROR"),!1)}})}function review(t){return $.ajax({url:"../../process/add-review.php",type:"post",dataType:"json",data:{content:$("#content").val(),rating:$("#rateit2").rateit("value"),idb:t},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?(""!=t.err?($("#err").html(t.err),$("#err").show("fast")):$("#err").hide("fast"),void("done"==t.done&&($("#noreview").hide("fast"),$("#review").before(t.html),$("#content").val(""),$("#rateit2").rateit("reset")))):(alert("ERROR"),!1)}}),!1}function comment(t){return $.ajax({url:"../../process/add-comment.php",type:"post",dataType:"json",data:{content:$("#content2").val(),idb:t},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?(""!=t.err?($("#err2").html(t.err),$("#err2").show("fast")):$("#err2").hide("fast"),void("done"==t.done&&($("#nocomment").hide("fast"),$("#comment").before(t.html),$("#content2").val("")))):(alert("ERROR"),!1)}}),!1}function pulsw(t){$("#"+t).pulsate({color:"#dfba49",repeat:!1})}function pulse(t){$("#"+t).pulsate({color:"#f3565d",repeat:!1})}function cancelsubscribe(){return $.ajax({url:"../../process/cancel-subscribe-check.php",type:"post",dataType:"json",data:{email:$("#email").val()},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?("0"!=t.email?("1"==t.email&&($("#erremail").attr({"data-original-title":"Chưa nhập địa chỉ email","class":"fa fa-warning tooltips"}),$("#emaildiv").attr("class","form-group has-warning"),pulsw("email")),"2"==t.email&&($("#erremail").attr({"data-original-title":"Địa chỉ email này chưa đăng ký theo dõi","class":"fa fa-exclamation tooltips"}),$("#emaildiv").attr("class","form-group has-error"),pulse("email")),"3"==t.email&&($("#erremail").attr({"data-original-title":"Địa chỉ email không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#emaildiv").attr("class","form-group has-error"),pulse("email")),Metronic.scrollTo2($("#emaildiv"),-200)):($("#erremail").attr({"data-original-title":"Địa chỉ email đã đăng ký theo dõi","class":"fa fa-check tooltips"}),$("#emaildiv").attr("class","form-group has-success")),void(1==t.done?$("#done").show("fast"):$("#done").hide("fast"))):(alert("ERROR"),!1)}}),!1}function changepass(){return $.ajax({url:"../../process/change-pass-check.php",type:"post",dataType:"json",data:{pass1:md5($("#pass1").val()),password:md5($("#password").val()),confirmpassword:md5($("#confirmpassword").val())},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?(0!=t.pass1?("1"==t.pass1&&($("#errpass1").attr({"data-original-title":"Chưa nhập mật khẩu","class":"fa fa-warning tooltips"}),$("#pass1div").attr("class","form-group has-warning"),pulsw("pass1")),"2"==t.pass1&&($("#errpass1").attr({"data-original-title":"Mật khẩu chưa chính xác","class":"fa fa-exclamation tooltips"}),$("#pass1div").attr("class","form-group has-error"),pulse("pass1")),Metronic.scrollTo2($("#pass1div"),-200)):($("#errpass1").attr({"data-original-title":"Mật khẩu chính xác","class":"fa fa-check tooltips"}),$("#pass1div").attr("class","form-group has-success"),0!=t.password?("1"==t.password&&($("#errpassword").attr({"data-original-title":"Chưa nhập mật khẩu mới","class":"fa fa-warning tooltips"}),$("#passworddiv").attr("class","form-group has-warning"),pulsw("password")),Metronic.scrollTo2($("#passworddiv"),-200)):($("#errpassword").attr({"data-original-title":"Mật khẩu mới hợp lệ","class":"fa fa-check tooltips"}),$("#passworddiv").attr("class","form-group has-success"),0!=t.confirmpassword?("1"==t.confirmpassword&&($("#errconfirmpassword").attr({"data-original-title":"Chưa xác nhận mật khẩu mới","class":"fa fa-warning tooltips"}),$("#confirmpassworddiv").attr("class","form-group has-warning"),pulsw("confirmpassword")),"2"==t.confirmpassword&&($("#errconfirmpassword").attr({"data-original-title":"Xác nhận mật khẩu chưa chính xác","class":"fa fa-exclamation tooltips"}),$("#confirmpassworddiv").attr("class","form-group has-error"),pulse("confirmpassword")),Metronic.scrollTo2($("#confirmpassworddiv"),-200)):($("#errconfirmpassword").attr({"data-original-title":"Xác nhận mật khẩu mới chính xác","class":"fa fa-check tooltips"}),$("#confirmpassworddiv").attr("class","form-group has-success")))),void(1==t.done?$("#done").show("fast"):$("#done").hide("fast"))):(alert("ERROR"),!1)}}),!1}function forgot(){return $.ajax({url:"../../process/forgot-check.php",type:"post",dataType:"json",data:{email:$("#email").val()},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?(0!=t.email?("1"==t.email&&($("#erremail").attr({"data-original-title":"Chưa nhập địa chỉ email","class":"fa fa-warning tooltips"}),$("#emaildiv").attr("class","form-group has-warning"),pulsw("email")),"2"==t.email&&($("#erremail").attr({"data-original-title":"Địa chỉ email này chưa được đăng ký","class":"fa fa-exclamation tooltips"}),$("#emaildiv").attr("class","form-group has-error"),pulse("email")),"3"==t.email&&($("#erremail").attr({"data-original-title":"Địa chỉ email không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#emaildiv").attr("class","form-group has-error"),pulse("email")),Metronic.scrollTo2($("#emaildiv"),-200)):($("#erremail").attr({"data-original-title":"Địa chỉ email chính xác","class":"fa fa-check tooltips"}),$("#emaildiv").attr("class","form-group has-success")),void("1"==t.done?$("#done").show("fast"):$("#done").hide("fast"))):(alert("ERROR"),!1)}}),!1}function login(){return $.ajax({url:"../../process/login-check.php",type:"post",dataType:"json",data:{scode:$("#scode").val(),password:md5($("#password").val()),remember:$("#remember").val(),ref:$("#ref").val()},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?("0"!=t.scode?("1"==t.scode&&($("#errscode").attr({"data-original-title":"Chưa nhập mã học sinh","class":"fa fa-warning tooltips"}),$("#scodediv").attr("class","form-group has-warning"),pulsw("scode")),"2"==t.scode&&($("#errscode").attr({"data-original-title":"Mã học sinh chưa chính xác","class":"fa fa-exclamation tooltips"}),$("#scodediv").attr("class","form-group has-error"),pulse("scode")),"3"==t.scode&&($("#errscode").attr({"data-original-title":"Mã học sinh không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#scodediv").attr("class","form-group has-error"),pulse("scode")),Metronic.scrollTo2($("#scodediv"),-200)):($("#errscode").attr({"data-original-title":"Mã học sinh chính xác","class":"fa fa-check tooltips"}),$("#scodediv").attr("class","form-group has-success"),"0"!=t.password?("1"==t.password&&($("#errpassword").attr({"data-original-title":"Chưa nhập mật khẩu","class":"fa fa-warning tooltips"}),$("#passworddiv").attr("class","form-group has-warning"),pulsw("password")),"2"==t.password&&($("#errpassword").attr({"data-original-title":"Mật khẩu chưa chính xác","class":"fa fa-exclamation tooltips"}),$("#passworddiv").attr("class","form-group has-error"),pulse("password")),Metronic.scrollTo2($("#passworddiv"),-200)):($("#errpassword").attr({"data-original-title":"Mật khẩu chính xác","class":"fa fa-check tooltips"}),$("#passworddiv").attr("class","form-group has-success"))),void(1==t.done?($("#done").html("Đăng nhập thành công"),$("#done").removeClass("alert-warning"),$("#done").addClass("alert-success"),$("#done").show("fast"),-1!=$("#ref").val().indexOf("localhost")&&(window.location=$("#ref").val())):2==t.done?($("#done").html("Tài khoản chưa được xác minh, vui lòng liên hệ BQT nếu cần thiết"),$("#done").removeClass("alert-success"),$("#done").addClass("alert-warning"),$("#done").show("fast")):$("#done").hide("fast"))):(alert("ERROR"),!1)}}),!1}function register(){return $.ajax({url:"../../process/register-check.php",type:"post",dataType:"json",data:{name:$("#name").val(),email:$("#email").val(),class1:$("#class").val(),birthday:$("#birthday").val(),scode:$("#scode").val(),password:md5($("#password").val()),confirmpassword:md5($("#confirmpassword").val()),sub:$("#sub").val()},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?("0"!=t.name?($("#errname").attr({"data-original-title":"Chưa nhập tên","class":"fa fa-warning tooltips"}),$("#namediv").attr("class","form-group has-warning"),pulsw("name"),Metronic.scrollTo2($("#namediv"),-200)):($("#errname").attr({"data-original-title":"Tên hợp lệ","class":"fa fa-check tooltips"}),$("#namediv").attr("class","form-group has-success"),"0"!=t.class?("1"==t.class&&($("#errclass").attr({"data-original-title":"Chưa nhập lớp","class":"fa fa-warning tooltips"}),$("#classdiv").attr("class","form-group has-warning"),pulsw("class")),"3"==t.class&&($("#errclass").attr({"data-original-title":"Lớp không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#classdiv").attr("class","form-group has-error"),pulse("class")),Metronic.scrollTo2($("#classdiv"),-200)):($("#errclass").attr({"data-original-title":"Lớp hợp lệ","class":"fa fa-check tooltips"}),$("#classdiv").attr("class","form-group has-success"),"0"!=t.birthday?("1"==t.birthday&&($("#errbirthday").attr({"data-original-title":"Chưa nhập ngày sinh","class":"fa fa-warning tooltips"}),$("#birthdaydiv").attr("class","form-group has-warning"),pulsw("birthday")),"3"==t.birthday&&($("#errbirthday").attr({"data-original-title":"Ngày sinh không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#birthdaydiv").attr("class","form-group has-error"),pulse("birthday")),Metronic.scrollTo2($("#birthdaydiv"),-200)):($("#errbirthday").attr({"data-original-title":"Ngày sinh hợp lệ","class":"fa fa-check tooltips"}),$("#birthdaydiv").attr("class","form-group has-success"),"0"!=t.email?("1"==t.email&&($("#erremail").attr({"data-original-title":"Chưa nhập địa chỉ email","class":"fa fa-warning tooltips"}),$("#emaildiv").attr("class","form-group has-warning"),pulsw("email")),"2"==t.email&&($("#erremail").attr({"data-original-title":"Địa chỉ email này chưa được đăng ký","class":"fa fa-exclamation tooltips"}),$("#emaildiv").attr("class","form-group has-error"),pulse("email")),"3"==t.email&&($("#erremail").attr({"data-original-title":"Địa chỉ email không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#emaildiv").attr("class","form-group has-error"),pulse("email")),Metronic.scrollTo2($("#emaildiv"),-200)):($("#erremail").attr({"data-original-title":"Địa chỉ email hợp lệ","class":"fa fa-check tooltips"}),$("#emaildiv").attr("class","form-group has-success"),"0"!=t.scode?("1"==t.scode&&($("#errscode").attr({"data-original-title":"Chưa nhập mã học sinh","class":"fa fa-warning tooltips"}),$("#scodediv").attr("class","form-group has-warning"),pulsw("scode")),"3"==t.scode&&($("#errscode").attr({"data-original-title":"Mã học sinh không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#scodediv").attr("class","form-group has-error")),Metronic.scrollTo2($("#scodediv"),-200)):($("#errscode").attr({"data-original-title":"Mã học sinh hợp lệ","class":"fa fa-check tooltips"}),$("#scodediv").attr("class","form-group has-success"),"0"!=t.password?($("#errpassword").attr({"data-original-title":"Chưa nhập mật khẩu","class":"fa fa-warning tooltips"}),$("#passworddiv").attr("class","form-group has-warning"),pulsw("password"),Metronic.scrollTo2($("#passworddiv"),-200)):($("#errpassword").attr({"data-original-title":"Mật khẩu hợp lệ","class":"fa fa-check tooltips"}),$("#passworddiv").attr("class","form-group has-success"),"0"!=t.confirmpassword?("1"==t.confirmpassword&&($("#errconfirmpassword").attr({"data-original-title":"Chưa xác nhận mật khẩu","class":"fa fa-warning tooltips"}),$("#confirmpassworddiv").attr("class","form-group has-warning"),pulsw("confirmpassword")),"2"==t.confirmpassword&&($("#errconfirmpassword").attr({"data-original-title":"Xác nhận mật khẩu chưa chính xác","class":"fa fa-exclamation tooltips"}),$("#confirmpassworddiv").attr("class","form-group has-error"),pulse("confirmpassword")),Metronic.scrollTo2($("#confirmpassworddiv"),-200)):($("#errconfirmpassword").attr({"data-original-title":"Xác nhận mật khẩu chính xác","class":"fa fa-check tooltips"}),$("#confirmpassworddiv").attr("class","form-group has-success")))))))),void("1"==t.done?$("#done").show("fast"):$("#done").hide("fast"))):(alert("ERROR"),!1)}}),!1}function subscribe(){return $.ajax({url:"../../process/subscribe-check.php",type:"post",dataType:"json",data:{email:$("#email").val()},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?("0"!=t.email?("1"==t.email&&($("#erremail").attr({"data-original-title":"Chưa nhập địa chỉ email","class":"fa fa-warning tooltips"}),$("#emaildiv").attr("class","form-group has-warning"),pulsw("email")),"2"==t.email&&($("#erremail").attr({"data-original-title":"Địa chỉ email này đã đăng ký theo dõi","class":"fa fa-exclamation tooltips"}),$("#emaildiv").attr("class","form-group has-error"),pulse("email")),"3"==t.email&&($("#erremail").attr({"data-original-title":"Địa chỉ email không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#emaildiv").attr("class","form-group has-error"),pulse("email")),Metronic.scrollTo2($("#emaildiv"),-200)):($("#erremail").attr({"data-original-title":"Địa chỉ email chưa đăng ký theo dõi","class":"fa fa-check tooltips"}),$("#emaildiv").attr("class","form-group has-success")),void("1"==t.done?$("#done").show("fast"):$("#done").hide("fast"))):(alert("ERROR"),!1)}}),!1}function changeimagemethod(){var t=$("#imagemethod").val();"1"==t?($("#image").attr("style","padding-left: 5px;padding-top: 5px;"),$("#image").attr("type","file"),$("#errimage").attr("style","display: block;")):"2"==t?($("#image").attr("style",""),$("#image").attr("type","text"),$("#errimage").attr("style","display: block;")):"3"==t&&($("#image").attr("style","display: none;"),$("#errimage").attr("style","display: none;"))}function request(){var t=new FormData(document.getElementById("request"));return $.ajax({url:"../../process/request-check.php",type:"post",dataType:"json",data:t,processData:!1,contentType:!1,enctype:"multipart/form-data",success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?("1"==t.title?($("#errtitle").attr({"data-original-title":"Chưa nhập địa chỉ tên sách","class":"fa fa-warning tooltips"}),$("#titlediv").attr("class","form-group has-warning"),pulsw("title"),Metronic.scrollTo2($("#titlediv"),-200)):($("#errtitle").attr({"data-original-title":"Tên sách hợp lệ","class":"fa fa-check tooltips"}),$("#titlediv").attr("class","form-group has-success"),"1"==t.author?($("#errauthor").attr({"data-original-title":"Chưa nhập tác giả","class":"fa fa-warning tooltips"}),$("#authordiv").attr("class","form-group has-warning"),pulsw("author"),Metronic.scrollTo2($("#authordiv"),-200)):($("#errauthor").attr({"data-original-title":"Tác giả hợp lệ","class":"fa fa-check tooltips"}),$("#authordiv").attr("class","form-group has-success"),"0"!=t.image?("1"==t.image&&($("#errimage").attr({"data-original-title":"Chưa chọn ảnh","class":"fa fa-warning tooltips"}),$("#imagediv").attr("class","form-group has-warning"),pulsw("image")),"2"==t.image&&($("#errimage").attr({"data-original-title":"Ảnh không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#imagediv").attr("class","form-group has-error"),pulse("image")),"3"==t.image&&($("#errimage").attr({"data-original-title":"Ảnh quá nặng","class":"fa fa-exclamation tooltips"}),$("#imagediv").attr("class","form-group has-error"),pulse("image")),Metronic.scrollTo2($("#imagediv"),-200)):($("#errimage").attr({"data-original-title":"Ảnh hợp lệ","class":"fa fa-check tooltips"}),$("#imagediv").attr("class","form-group has-success"),$("#errreason").attr({"data-original-title":"Lý do hợp lệ hoặc không có lý do","class":"fa fa-check tooltips"}),$("#reasondiv").attr("class","form-group has-success")))),void("1"==t.done?$("#done").show("fast"):$("#done").hide("fast"))):(alert("ERROR"),!1)}}),!1}function contribute(){var t=new FormData(document.getElementById("request"));return $.ajax({url:"../../process/contribute-check.php",type:"post",dataType:"json",data:t,processData:!1,contentType:!1,enctype:"multipart/form-data",success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?("1"==t.title?($("#errtitle").attr({"data-original-title":"Chưa nhập địa chỉ tên sách","class":"fa fa-warning tooltips"}),$("#titlediv").attr("class","form-group has-warning"),pulsw("title"),Metronic.scrollTo2($("#titlediv"),-200)):($("#errtitle").attr({"data-original-title":"Tên sách hợp lệ","class":"fa fa-check tooltips"}),$("#titlediv").attr("class","form-group has-success"),"1"==t.author?($("#errauthor").attr({"data-original-title":"Chưa nhập tác giả","class":"fa fa-warning tooltips"}),$("#authordiv").attr("class","form-group has-warning"),pulsw("author"),Metronic.scrollTo2($("#authordiv"),-200)):($("#errauthor").attr({"data-original-title":"Tác giả hợp lệ","class":"fa fa-check tooltips"}),$("#authordiv").attr("class","form-group has-success"),"0"!=t.image?("1"==t.image&&($("#errimage").attr({"data-original-title":"Chưa chọn ảnh","class":"fa fa-warning tooltips"}),$("#imagediv").attr("class","form-group has-warning"),pulsw("image")),"2"==t.image&&($("#errimage").attr({"data-original-title":"Ảnh không hợp lệ","class":"fa fa-exclamation tooltips"}),$("#imagediv").attr("class","form-group has-error"),pulse("image")),"3"==t.image&&($("#errimage").attr({"data-original-title":"Ảnh quá nặng","class":"fa fa-exclamation tooltips"}),$("#imagediv").attr("class","form-group has-error"),pulse("image")),Metronic.scrollTo2($("#imagediv"),-200)):($("#errimage").attr({"data-original-title":"Ảnh hợp lệ","class":"fa fa-check tooltips"}),$("#imagediv").attr("class","form-group has-success"),$("#errreason").attr({"data-original-title":"Lý do hợp lệ hoặc không có lý do","class":"fa fa-check tooltips"}),$("#reasondiv").attr("class","form-group has-success")))),void("1"==t.done?$("#done").show("fast"):$("#done").hide("fast"))):(alert("ERROR"),!1)}}),!1}function get_new_notify(){return $.ajax({url:"../../process/get-new-notify.php",type:"post",dataType:"json",success:function(t){if(t){get_unseen_notify();for(var a=0;a<t.length;a++)toastr[t[a].type]("<a onclick='seen_notify("+t[a].id+")' style='color: #fff; text-decoration: none;' href='../../"+t[a].link+"'>"+t[a].content+"</a>"),noti=new Notification("Thông báo mới từ thư viện trực tuyến trường THPT Lê Quý Đôn",{lang:"vi-VN",icon:"http://thuvienlqd.com/assets/global/img/noti-image.png",body:t[a].content}),setTimeout(function(){noti.close()},5e3)}}}),!1}function get_unseen_notify(){return $.ajax({url:"../../process/get-unseen-notify.php",type:"post",dataType:"json",success:function(t){if(t){for(var a="",r=0;r<t.length;r++)a+="<li><strong class='noticontent2'><a onclick='seen_notify("+t[r].id+")' href='../../"+t[r].link+"'>"+t[r].content+"</a></strong><div class='notitime'>"+t[r].time+"</div></li>";$("#noticontent").html(a),$("#noticount").html(t.length),$(document).attr("title","("+t.length+") "+title)}else $("#noticontent").html("<center>Bạn không có thông báo mới nào</center>"),$("#noticount").html("0"),$(document).attr("title",title)}}),!1}function seen_notify(t){return $.ajax({url:"../../process/seen-notify.php",type:"post",dataType:"json",data:{id:t}}),get_unseen_notify(),!1}function seen_all(){return $.ajax({url:"../../process/seen-notify.php",type:"post",dataType:"json",data:{all:1}}),get_unseen_notify(),!1}function hideAllAcco(){$("#agree-term-content").hide("fast",function(){$("#agree-term-content").removeClass("in").css("display","")}),$("#confirm-password-content").hide("fast",function(){$("#confirm-password-content").removeClass("in").css("display","")}),$("#confirm-info-content").hide("fast",function(){$("#confirm-info-content").removeClass("in").css("display","")}),$("#borrow-method-content").hide("fast",function(){$("#borrow-method-content").removeClass("in").css("display","")}),$("#confirm-content").hide("fast",function(){$("#confirm-content").removeClass("in").css("display","")})}function checkout(){return $.ajax({url:"../../process/checkout.php",type:"post",dataType:"json",data:{acceptterm:$('[name="agree-term-value"]:checked').val(),pass:md5($("#pass").val()),confirminfo:$('[name="confirm-info-value"]:checked').val(),borrowmethod:$('[name="borrow-method-value"]:checked').val(),note:$("#borrow-note").val()},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?("1"==t.acceptterm?(hideAllAcco(),$("#agree-term-content").collapse("show"),$("#agree-term-checkbox").pulsate({color:"#f3565d",repeat:2})):"0"!=t.pass?(hideAllAcco(),$("#confirm-password-content").collapse("show"),"1"==t.pass&&($("#errpass").attr({"data-original-title":"Chưa nhập mật khẩu","class":"fa fa-warning tooltips"}),$("#passdiv").attr("class","form-group has-warning"),$("#pass").pulsate({color:"#dfba49",repeat:2})),"2"==t.pass&&($("#errpass").attr({"data-original-title":"Mật khẩu chưa chính xác","class":"fa fa-exclamation tooltips"}),$("#passdiv").attr("class","form-group has-error"),$("#pass").pulsate({color:"#f3565d",repeat:2}))):($("#errpass").attr({"data-original-title":"Mật khẩu chính xác","class":"fa fa-check tooltips"}),$("#passdiv").attr("class","form-group has-success"),"1"==t.confirminfo?(hideAllAcco(),$("#confirm-info-content").collapse("show"),$("#confirm-info-checkbox").pulsate({color:"#f3565d",repeat:2})):"1"==t.borrowmethod&&(hideAllAcco(),$("#borrow-method-content").collapse("show"),$("#borrow-method-radio").pulsate({color:"#f3565d",repeat:2}))),1==t.limit&&bootbox.dialog({message:"Bạn đã có 1 đơn sách đang được xác nhận (hoặc đang mượn), vui lòng hủy đơn sách (hoặc trả sách) để đặt thêm đơn sách mới!",title:"Không thể đặt thêm đơn sách",buttons:{main:{label:"Xem lại đơn sách",className:"btn-primary",callback:function(){window.location="../../donsach"
}}}}),void(1==t.done&&bootbox.alert("Đặt sách thành công",function(){window.location="../../donsach"}))):(alert("ERROR"),!1)}}),!1}function cancelorder(t){return bootbox.confirm("Bạn có chắc muốn hủy đơn sách?",function(a){1==a&&$.ajax({url:"../../process/cancel-order.php",type:"post",dataType:"json",data:{id:t},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?void(1==a.done&&bootbox.alert("Hủy đơn sách thành công",function(){$("#orderTus"+t).removeClass("label-warning").removeClass("label-default").removeClass("label-primary").removeClass("label-success").addClass("label-danger").text("Đã hủy"),$("#btncancel"+t).hide(function(){$("#btncancel"+t).remove()})})):(alert("ERROR"),!1)}})}),!1}function cancelorder2(t){return bootbox.confirm("Bạn có chắc muốn hủy đơn sách?",function(a){1==a&&$.ajax({url:"../../process/cancel-order.php",type:"post",dataType:"json",data:{id:t},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?void(1==t.done&&bootbox.alert("Hủy đơn sách thành công",function(){window.location=""})):(alert("ERROR"),!1)}})}),!1}function editMethod(t){$("#editMethodSn").text("Mượn về"==$("#editMethodSn").text()?"Đọc tại chỗ":"Mượn về"),$("#editMethodBtn").html('<i class="fa fa-save"></i> Lưu/Hủy</a>'),$("#editMethodBtn").attr("onclick","editMethod2("+t+")")}function editMethod2(t){return bootbox.confirm("Có chắc muốn sửa hình thức mượn của đơn sách này?",function(a){1==a?$.ajax({url:"../../process/edit-method-order.php",type:"post",dataType:"json",data:{id:t},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?void("1"==a.done&&($("#editMethodBtn").html('<i class="fa fa-edit"></i> Sửa</a>'),$("#editMethodBtn").attr("onclick","editMethod("+t+")"))):(alert("ERROR"),!1)}}):($("#editMethodSn").text("Mượn về"==$("#editMethodSn").text()?"Đọc tại chỗ":"Mượn về"),$("#editMethodBtn").html('<i class="fa fa-edit"></i> Sửa</a>'),$("#editMethodBtn").attr("onclick","editMethod("+t+")"))}),!1}function editNote(t){$("#editNoteSn").html('<textarea class="form-control" id="editNoteValue">'+$("#editNoteSn").html()+"</textarea>"),$("#editNoteBtn").html('<i class="fa fa-save"></i> Lưu/Hủy</a>'),$("#editNoteBtn").attr("onclick","editNote2("+t+")")}function editNote2(t){return bootbox.confirm("Có chắc muốn sửa ghi chú của đơn sách này?",function(a){$.ajax(1==a?{url:"../../process/edit-note-order.php",type:"post",dataType:"json",data:{id:t,note:$("#editNoteValue").val()},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?void("1"==t.done&&$("#editNoteSn").html($("#editNoteValue").val())):(alert("ERROR"),!1)}}:{url:"../../process/edit-note-order.php",type:"post",dataType:"json",data:{id:t,type:1},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?void("1"==t.done&&$("#editNoteSn").text(t.note)):(alert("ERROR"),!1)}})}),$("#editNoteBtn").html('<i class="fa fa-edit"></i> Sửa</a>'),$("#editNoteBtn").attr("onclick","editNote("+t+")"),!1}function delEachOrder(t,a){return bootbox.confirm("Có chắc muốn xóa sách này khỏi đơn sách?",function(r){1==r&&$.ajax({url:"../../process/del-eachorder.php",type:"post",dataType:"json",data:{id:t,id2:a},success:function(a){return a.hasOwnProperty("error")&&"success"==a.error?void("1"==a.done&&$("#eachorder"+t).hide("slow",function(){$("#eachorder"+t).remove()})):(alert("ERROR"),!1)}})}),!1}function reConfirmOrder(t){return bootbox.confirm("Bạn đã kiểm tra kỹ lại đơn sách?",function(a){1==a&&$.ajax({url:"../../process/reconfirm-order.php",type:"post",dataType:"json",data:{id:t},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?void("1"==t.done&&bootbox.alert("Xác nhận lại đơn sách thành công!",function(){window.location.reload()})):(alert("ERROR"),!1)}})}),!1}function search(){return window.location="../../tim-kiem/"+encodeURIComponent($("#txtSearch").val()),!1}function search2(){return window.location="../../tim-kiem/"+encodeURIComponent($("#txtSearch2").val()),!1}$("#rateit").bind("rated",function(){return $.ajax({url:"../../process/rating.php",type:"post",dataType:"json",data:{value:$("#rateit").rateit("value"),bookid:$("#rateit").data("bookid")},success:function(t){return t.hasOwnProperty("error")&&"success"==t.error?void 0:(alert("ERROR"),!1)}}),!1});var title=$(document).attr("title"),Notification=window.Notification||window.mozNotification||window.webkitNotification;Notification.requestPermission();var noti=[];get_unseen_notify(),get_new_notify(),setInterval("get_new_notify()",1e3),setInterval("get_unseen_notify()",6e4);